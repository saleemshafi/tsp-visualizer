<html>
<head>
<style type="text/css">
  #container {
    max-width: 50%;
    height: 100%;
    margin-left: auto;
    border-left: 1px solid #666;
  }
  #data {
  	float: left;
  	width: 50%;
  }
  textarea {
  	height: 40%;
  	width: 95%;
  }
  .section {
  	width: 100%;
  }
</style>
</head>
<body>
<div id="data">
<div class="section">
<h3>Nodes</h3>
<ul>
<li><a href="#" onclick="loadNodes('tsp_51_1')">Problem 1</a></li>
<li><a href="#" onclick="loadNodes('tsp_100_3')">Problem 2</a></li>
<li><a href="#" onclick="loadNodes('tsp_200_2')">Problem 3</a></li>
<li><a href="#" onclick="loadNodes('tsp_574_1')">Problem 4</a></li>
<li><a href="#" onclick="loadNodes('tsp_1889_1')">Problem 5</a></li>
<li><a href="#" onclick="loadNodes('tsp_33810_1')">Problem 6</a></li>
</ul>
</div>
<div class="section">
<h3>Path</h3>
<p>Paste your node list here to see the path through the nodes.</p>
<textarea id="path"></textarea>
</div>
<label>Distance: </label><span id="distance"></span>
</div>
<div id="container"></div>
<script src="sigma/sigma.min.js"></script>
<script src="sigma/plugins/sigma.parsers.json.min.js"></script>
<script src="sigma.parsers.tsp.js"></script>
<script>
  var s = null;
  var g = {
		  nodes: [],
		  edges: []
  }
  
  var ePath = document.getElementById("path");
  ePath.addEventListener("keyup", updatePath);
  
  function updatePath() {
	 g.edges = sigma.parsers.tsp.edges(ePath.value);
	 drawGraph(g);
  }
  
  function drawGraph(graph) {
		 var container = document.getElementById("container");
		 while (container.firstChild) {
			container.removeChild(container.firstChild);
		 }
		 document.getElementById("distance").textContent = cycleLength(graph);
		 new sigma({
			 graph: graph,
			 container: 'container',
			 settings: {
				 minNodeSize: 0,
				 maxNodeSize: 2,
				 defaultNodeColor: '#3333FF'
			 }
		 });
  }
  
  function loadNodes(nodeFile) {
	  sigma.parsers.tsp.fileNodes(nodeFile, g, function(g1) {
		  updatePath();
	  });
  }
  
  function cycleLength(graph) {
	  var nodeMap = {}
	  graph.nodes.forEach(function(n) {
		 nodeMap[n.id] = n; 
	  });
	  var dist = 0;
	  graph.edges.forEach(function(e) {
		 dist += edgeLength(nodeMap[e.source], nodeMap[e.target]); 
	  });
	  return dist;
  }
  
  function edgeLength(a, b) {
	  return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2))
  }
  
  loadNodes('tsp_51_1');
  
</script>
</body>
</html>
